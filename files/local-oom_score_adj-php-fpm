#!/bin/bash
#
# Managed by ansible (mit.webserver.php)
# DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
#
# v2018-09-03 by markus.meissner@meissner.IT
# 
# Tested on 
# * Debian 8 (php5-fpm)
# * Debian 9 (php7.0-fpm)
# * Debian 9 (php7.3-fpm from packages.sury.org)

# Instead of reducing the score of mysql we increase the score of php-fpm. This
# can be done on any server using php. If we would set the mysql score we have to
# adjust the score on pure mysql-servers.
#pgrep -f /usr/sbin/mysqld | while read PID; do echo "-900" >| /proc/$PID/oom_score_adj; done
pgrep -f php-fpm | while read PID; do echo "+900" > /proc/$PID/oom_score_adj; done

